<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Shotnow - جدول المباريات</title>

  <!-- SEO Meta Tags & Favicon -->
  <meta name="description" content="تابع جدول مباريات كرة القدم مباشرة: دوري أبطال أوروبا، الدوري الإنجليزي، الإسباني، الإيطالي، الألماني، الفرنسي، وكأس العالم.">
  <meta name="keywords" content="Shotnow, مباريات اليوم, نتائج المباريات, جدول المباريات, كرة القدم, مباشر, الدوري الإنجليزي, دوري أبطال أوروبا, الدوري الإسباني">
  <meta name="author" content="Shotnow">

  <link rel="icon" type="image/jpeg" href="https://i.ibb.co/v43rwzhx/fav.jpg">
  <link rel="shortcut icon" href="https://i.ibb.co/v43rwzhx/fav.jpg" type="image/jpeg">

  <!-- Open Graph -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="Shotnow - جدول مباريات كرة القدم مباشرة">
  <meta property="og:description" content="تابع مباريات أهم الدوريات العالمية مباشرة مع Shotnow.">
  <meta property="og:image" content="https://i.ibb.co/v43rwzhx/fav.jpg">

  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:title" content="Shotnow - جدول مباريات كرة القدم مباشرة">
  <meta property="twitter:description" content="تابع مباريات أهم الدوريات العالمية مباشرة مع Shotnow.">
  <meta property="twitter:image" content="https://i.ibb.co/v43rwzhx/fav.jpg">

  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Cairo', sans-serif;
      background-color: #0f172a; /* slate-900 */
    }
    .match-card:hover { background-color: #1e293b; }
    ::-webkit-scrollbar { width: 8px; }
    ::-webkit-scrollbar-thumb { background: #475569; border-radius: 10px; }
  </style>
</head>
<body class="text-white">

  <!-- Header -->
  <header class="text-center my-8">
    <h1 class="text-4xl md:text-5xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-emerald-400 to-cyan-400">
      Shotnow
    </h1>
    <p class="text-slate-400 mt-2">جدول مباريات اليوم وأهم الدوريات</p>
  </header>

  <!-- Controls -->
  <div class="container mx-auto max-w-4xl px-4">
    <div class="bg-slate-800/60 backdrop-blur-sm p-3 rounded-xl mb-6 space-y-4">
      <!-- Date Navigation -->
      <div class="flex items-center justify-center gap-2">
        <button id="next-day-btn" class="px-4 py-2 bg-slate-700 hover:bg-slate-600 rounded-lg">الغد &larr;</button>
        <input type="date" id="date-picker" class="bg-slate-700 rounded-lg p-2 text-center w-36">
        <button id="prev-day-btn" class="px-4 py-2 bg-slate-700 hover:bg-slate-600 rounded-lg">&rarr; الأمس</button>
      </div>
      <!-- Live filter -->
      <div class="flex justify-center">
        <button id="live-filter-btn" class="px-4 py-2 bg-slate-700 hover:bg-slate-600 rounded-lg">مباريات مباشرة</button>
      </div>
    </div>

    <!-- Matches -->
    <main id="matches-container" class="space-y-6"></main>
    <div id="message-display" class="text-center p-8 text-slate-400 hidden"></div>
  </div>

  <script>
    const datePicker = document.getElementById('date-picker');
    const matchesContainer = document.getElementById('matches-container');
    const messageDisplay = document.getElementById('message-display');
    const prevDayBtn = document.getElementById('prev-day-btn');
    const nextDayBtn = document.getElementById('next-day-btn');
    const liveFilterBtn = document.getElementById('live-filter-btn');

    const API_HOST = 'v3.football.api-sports.io';
    const apiKey = '55775c372432e6e6384f99b06466bd4a';
    let allMatchesData = [];
    let showOnlyLive = false;

    // الدوريات المهمة فقط
    const importantLeagues = [1, 4, 21, 2, 39, 140, 135, 78, 61];

    function renderFixtures(data) {
      matchesContainer.innerHTML = '';
      const liveStatuses = ['1H', 'HT', '2H', 'ET', 'P'];

      let filteredMatches = data.filter(m => importantLeagues.includes(m.league.id));
      if (showOnlyLive) filteredMatches = filteredMatches.filter(m => liveStatuses.includes(m.fixture.status.short));

      if (filteredMatches.length === 0) {
        messageDisplay.textContent = 'لا توجد مباريات مطابقة.';
        messageDisplay.classList.remove('hidden');
        return;
      }
      messageDisplay.classList.add('hidden');

      const leaguesMap = new Map();
      filteredMatches.forEach(match => {
        if (!leaguesMap.has(match.league.id)) {
          leaguesMap.set(match.league.id, { league: match.league, matches: [] });
        }
        leaguesMap.get(match.league.id).matches.push(match);
      });

      leaguesMap.forEach(group => {
        const leagueDiv = document.createElement('div');
        leagueDiv.className = 'bg-slate-800/50 border border-slate-700 rounded-xl overflow-hidden';
        leagueDiv.innerHTML = `
          <div class="bg-slate-900/70 px-4 py-3 border-b border-slate-700 flex items-center gap-3">
            <img src="${group.league.logo}" class="w-6 h-6 object-contain">
            <h2 class="text-lg font-bold">${group.league.name}</h2>
          </div>
          <div class="divide-y divide-slate-800">
            ${group.matches.map(renderMatch).join('')}
          </div>`;
        matchesContainer.appendChild(leagueDiv);
      });
    }

    function renderMatch(match) {
      const { fixture, teams, goals } = match;
      const time = new Date(fixture.date).toLocaleTimeString('en-GB', { hour: '2-digit', minute: '2-digit' });
      let status = '';

      switch (fixture.status.short) {
        case 'NS': status = `<div class="text-lg font-bold text-slate-300">${time}</div>`; break;
        case '1H': case 'HT': case '2H': case 'ET': case 'P':
          status = `<div class="text-center"><div class="text-lg font-bold text-emerald-400">${goals.home ?? 0} - ${goals.away ?? 0}</div><div class="text-xs text-emerald-500 animate-pulse">مباشر ${fixture.status.elapsed}'</div></div>`; break;
        case 'FT': case 'AET': case 'PEN':
          status = `<div class="text-center"><div class="text-lg font-bold">${goals.home} - ${goals.away}</div><div class="text-xs text-slate-500">انتهت</div></div>`; break;
        default: status = `<div class="text-sm text-slate-400">${fixture.status.long}</div>`;
      }

      return `
        <div class="flex items-center justify-between p-4 match-card">
          <div class="flex items-center gap-3 w-2/5 justify-end">
            <span class="font-semibold text-right flex-1">${teams.home.name}</span>
            <img src="${teams.home.logo}" class="w-8 h-8 object-contain">
          </div>
          <div class="w-1/5 text-center">${status}</div>
          <div class="flex items-center gap-3 w-2/5">
            <img src="${teams.away.logo}" class="w-8 h-8 object-contain">
            <span class="font-semibold text-left flex-1">${teams.away.name}</span>
          </div>
        </div>`;
    }

    async function fetchMatches(date) {
      matchesContainer.innerHTML = `<div class="text-center text-slate-400 p-8">جاري تحميل المباريات...</div>`;
      try {
        const res = await fetch(`https://${API_HOST}/fixtures?date=${date}`, {
          headers: { 'x-rapidapi-host': API_HOST, 'x-rapidapi-key': apiKey }
        });
        const data = await res.json();
        allMatchesData = data.response;
        renderFixtures(allMatchesData);
      } catch (err) {
        messageDisplay.textContent = `خطأ: ${err.message}`;
        messageDisplay.classList.remove('hidden');
      }
    }

    function handleDateChange(offset) {
      const d = new Date(datePicker.value);
      d.setDate(d.getDate() + offset);
      datePicker.value = d.toISOString().split('T')[0];
      fetchMatches(datePicker.value);
    }

    // Events
    datePicker.addEventListener('change', () => fetchMatches(datePicker.value));
    prevDayBtn.addEventListener('click', () => handleDateChange(-1));
    nextDayBtn.addEventListener('click', () => handleDateChange(1));
    liveFilterBtn.addEventListener('click', () => {
      showOnlyLive = !showOnlyLive;
      liveFilterBtn.classList.toggle('bg-emerald-600');
      renderFixtures(allMatchesData);
    });

    // Init
    const today = new Date();
    datePicker.value = today.toISOString().split('T')[0];
    fetchMatches(datePicker.value);
  </script>
</body>
    </html>
